# Requirement

## Software and environment variables
See setup.txt under mapping/MouseResection/main/.

## Reference genomes
Download a chrom.sizes file into mapping/chrom.sizes/
Download bowtie2 index files into mapping/indexes/
Store peak files in mapping/peaks/GENOME/primary/
(Optional) Create matrix.Rdata files of control samples in matrix.Rdata/control/GENOME/
Detailed format instructions are described in each subdirectory of the mapping directory.


# Mapping reads
1. Rename directories and files of fastq data according to instructions in mapping/FASTQ/readme.txt.
2. Store the fastq files to mapping/FASTQ/.
3. Duplicate “template_mapping_mouse.sh” in /mapping/scripts/MouseResection/main/ and rename the file such as "Project_XXX_mapping_mouse.sh"
4. Open "Project_XXX_mapping_mouse.sh", modify "PROGECT", "NAME" and "GENOME" and save the script in /mapping/scripts/MouseResection/main/
5. Run the script by typing “bash <path to Project_XXX_mapping_mouse.sh>" and ENTER in the Terminal


# Outputs
Mapped results are stored in mapping/MAP/. If the PROJECT, NAME and GENOME in the mapping script are set as "Project_XXX", "NAME", and "mm10", respectively, quality check and trimming reports of sequencing reads are generated in the "fastqc" and "trimming" directories, respectively, under mapping/MAP/Project_XXX/. Map results are stored in mapping/MAP/Project_XXX/mm10/NAME/. The "NAME" in output file names are specified in the mapping script. The "F" in file names means that reads mapped on the top strand (forward reads) and the "R" means that reads mapped on the bottom strand (reverse reads).

## The sorted bam file and its index of the total mapped reads
- NAME.st.bam
- NAME.st.bam.bai

## The sorted bam file and its index of the uniquely and properly mapped reads
- NAME.uniq.bam
- NAME.uniq.bam.bai

## bigWig files of resection endpoints
Uniquely and properly mapped reads are counted at the nucleotide next to the biotinylated adapter was mapped.
- NAME.F.bw
- NAME.R.bw

## bigWig files of resection endpoints (bin read count in 25 bp)
- NAME.BIN.25.bp.rpm.F.bw
- NAME.BIN.25.bp.rpm.R.bw

## The number of uniquely and properly mapped reads
- NAME.rpm.txt

## Mapping statistics
- NAME.st.txt
- NAME.insert_size_histogram.1k.pdf
- NAME.insert_size_metrics.1k.txt
- NAME.marked_dup_metrics.txt
- NAME.uniq.idxstats.txt
- NAME.uniq.insert_size_metrics.1k.txt
- NAME.uniq.stats.txt

## Matrix for counts of reads mapped from -5600 to 5600 bp relative to the mouse SPO11-oligo hotspot center
matrix.txt.gz is generated by the deepTools computeMatrix tool.
matrix.Rdata contains a read count matrix of 13960 rows (each row contains signal around each SPO11-oligo hotspot center) and 11201 columns (each column contains signal at a position from -5600 to 5600 bp around the hotspot center).
- hotspot.center.SPO11.B6.Cell.mmc2.bed.NAME.F.halfwin.5600.matrix.txt.gz
- hotspot.center.SPO11.B6.Cell.mmc2.bed.NAME.R.halfwin.5600.matrix.txt.gz
- hotspot.center.SPO11.B6.Cell.mmc2.bed.NAME.F.halfwin.5600.matrix.Rdata
- hotspot.center.SPO11.B6.Cell.mmc2.bed.NAME.R.halfwin.5600.matrix.Rdata

## Plots
Data of "posctrl" matrix.Rdata file stored in matrix.Rdata/control/GENOME/ is plotted together with a newly mapped data of "NAME".
Data of "negctrl" matrix.Rdata file stored in matrix.Rdata/control/GENOME/ is used for background correction by subtracting "negctrl" signal from signal of the "NAME" sample.
The "plot.mean" in the file names means that the plot shows mean profiles around mouse SPO11-oligo hotspot centers
The "Spo11.null.subtracted" in the file names means that background is corrected by subtracting Spo11 null signal from the raw signal.
The "center.pdf" in the file names means that the plot shows zoom-in view at the hotspot center.

NAME is shown in red and the positive control (wild type) is shown in blue.
- plot.mean.hotspot.center.SPO11.B6.Cell.mmc2.bed.NAME.and.wild.type.pdf
- plot.mean.hotspot.center.SPO11.B6.Cell.mmc2.bed.Spo11.null.subtracted.NAME.and.wild.type.pdf

NAME is shown in orange and the positive control (wild type) is shown in black.
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.NAME.and.wild.type.pdf
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.NAME.and.wild.type.center.pdf

NAME is shown in orange and the positive control (wild type) is shown in black.
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.Spo11.null.subtracted.NAME.and.wild.type.pdf
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.Spo11.null.subtracted.NAME.and.wild.type.center.pdf

NAME is shown in orange and background signal is shown in black.
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.Spo11.null.subtracted.NAME.pdf
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.Spo11.null.subtracted.NAME.center.pdf

A profile around hotspots located non-PAR regions on sex chromosomes is shown in orange and a profile around hotspots on autosomes is shown in black.
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.Spo11.null.subtracted.sexchr.NAME.pdf
- plot.mean.strand.averaged.hotspot.center.SPO11.B6.Cell.mmc2.bed.Spo11.null.subtracted.sexchr.NAME.center.pdf
